<div class="menu-container">
  {% assign url_parts = page.url | split: '/' %}
  {% assign url_parts_size = url_parts | size %}
  {% assign rm = url_parts | last %}
  {% assign base_url = page.url | replace: rm %}
  
  <ul class="menu">
    {% for node in site.pages %}
    {% if node.url contains base_url %}
    {% assign node_url_parts = node.url | split: '/' %}
    {% assign node_url_parts_size = node_url_parts | size %}
    {% assign node_url_parts_size_next = node_url_parts_size | minus: 1 %}
    {% assign filename = node_url_parts | last %}
    {% if url_parts_size == node_url_parts_size_next and filename == 'index.html' %}
    <li><a class="{% if page.url == node.url %}bold{% endif %}" href='{{node.url}}'>{{node.title}}</a></li>
    {% endif %}
    {% if url_parts_size == node_url_parts_size and filename != 'index.html' and filename != 'blog.html' and filename != 'feed.xml' %}
    <li><a class="{% if page.url == node.url %}bold{% endif %}" href='{{node.url}}'>{{node.title}}</a></li>
    {% endif %}
    {% endif %}
    {% endfor %}
  </ul>
</div>
